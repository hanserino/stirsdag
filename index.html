<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stirsdag - run sti get high!</title>
    <meta property="og:site_name" content="Stirsdag"/>
    <meta property="og:title" content="Stirsdag - Run sti get high!"/>
    <meta property="og:description" content="Stirsdag med Sky Blazers. 12-16km stil칮ping hver tirsdag kl 18:00 fra Disen trikkestasjon."/>
    <meta property="og:image" content="media/pics/10.jpg">
    <meta property="og:url" content="http://stirsdag.no/">

    <link href="https://fonts.googleapis.com/css?family=Bungee+Shade" rel="stylesheet">
    <link rel="stylesheet" href="stylesheet.css" type="text/css">
  </head>
  <body>
      <main class="wrapper">
 
        <header class="section textOnPic" id="header" data-stirsdag="">
            <h1 id="isitQuestion">Er det Stirsdag idag?</h1>
            <p id="isitAnswer"></p>

            <nav class="nav">
                <ul>
                    <li><a href="#hva-faen-er-stirsdag">Hva faen er Stirsdag?</a></li>
                    <li><a href="#utstyr">Hva har man med seg p친 Stirsdag?</a></li>
                    <li><a href="#hvem-staar-bak">Hvem st친r bak Stirsdag?</a></li>
                </ul>
            </nav>
        </header>

        <section class="section animBg" id="hva-faen-er-stirsdag">
            <h1>Hva faen er Stirsdag?</h1>
            <p>Les <a href="https://www.strava.com/athletes/4595507/posts/677173">Hr. Rummelhoffs Strava-post</a>, s친 f친r du svaret. </p>
        </section>

        <section class="section animBg" id="utstyr">
            <h1>Hva skal jeg ha med meg?</h1>
            
            <p id="gearText"></p>
            
            <table id="gearTable">
                <tr>
                    <th>Plagg/utstyr</th>
                    <th>God id칠?</th>
                </tr>

                <tbody id="gearTableBody">

                </tbody>
            
            </table>

        </section>

        <section class="section animBg" id="hvem-staar-bak">
            <h1>Hvem st친r bak Stirsdag?</h1>
            <p>Stirsdag er et initiativ av l칮pecrewet Sky Blazers. Vi best친r av ca 10stk kvinner og menn som rett og slett elsker 친 l칮pe og konkurrere i r칮fft terreng. "Sky" kommer av at vi digger <a href="https://en.wikipedia.org/wiki/Skyrunning">skyrunning</a>. "Less cloud, more sky!", som de sier p친 fagspr친ket.</p>
            <p>Du finner oss i disse kanalene:</p>
            <ul>
                <li>Facebook: <a href="https://www.facebook.com/skyblazersrunning/">@skyblazersrunning</a></li>
                <li>Instagram: <a href="https://www.instagram.com/skyblazersrunning/">@skyblazersrunning</a></li>
                <li>Strava: <a href="https://www.strava.com/clubs/skyblazers">@skyblazers</a></li>
            </ul>
        </section>

        <section class="section animBg">
            <h1>Vi l칮pes! </h1>
            <p>Hilsen Sky Blazers & Co.</p>
            <div class="logo-container">
                <div class="logo-container__inner">
                    <img class="logo" src="media/skyblazerslogo.png" alt="Sky Blazers logo" />
                </div>
            </div>
        </section>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.3/es6-sham.map"></script>
    <script src="moment.js"></script>
    <script type="text/javascript">

        let headerEl = document.getElementById("header");        
        let isitAnswerEl = document.getElementById("isitAnswer");

        let degreesEl = document.getElementById("degrees");
        let gearTableBody = document.getElementById("gearTableBody");
        let gearTextEl = document.getElementById("gearText");

        let forecast = {
            "data": {}
        };


        let forecastUrl = 'https://www.yr.no/api/v0/locations/1-73569/forecast';

        let date = new Date(),
            day = date.getDay();
        
        let isStirsdag = day === 2 ? true : false;

        let daysUntilStirsdag = 7-day+2;
        let nextStirsdagDate = moment().locale('nb').day(9).format('Do MMMM');

        function randomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min)) + min;
        }

        const answers = {
            yes: [
                "Ja for faen! Vi ses p친 <a href='https://goo.gl/maps/cuhG4nfLZtM2'>Disen Trikkestopp</a> kl 17:50!",
                "Fuck yeah! Vi ses p친 <a href='https://goo.gl/maps/cuhG4nfLZtM2'>Disen Trikkestopp</a> kl 17:50!"
            ],
            no: [
                "Nope. Ta deg en bolle.",
                "Nei. Men ta deg en tur i skauen 친kke som da, for faen.",
                "Nei. Kanskje i dag er dagen hvor du skal teste ut HK's fam칮se <a target='_blank' href='https://medium.com/skyblazers/oppskrift-ultraboller-8eb07c8421ff'>Ultrabolle-oppskrift</a>? 游꼵"
            ]
        }

        function setBackground(number){
            headerEl.style.backgroundImage = `url("media/pics/${number}.jpg")`;
        }
        
        function weatherRow(item, goodIdea){
            let goodIdeaEmoji = goodIdea ? '游녨' : '游녩';

            return `<tr>
                        <td>${item}</td>
                        <td>${goodIdeaEmoji}</td>
                    </tr>`;
        }

        function init(){

            fetch(forecastUrl).then(function (response) {
                return response.json().then(function (data) {
                    forecast.data = data;

                    //Todo: get the yrInterval to hit midday inteval
                    let yrInterval = 4*daysUntilStirsdag;
                    let stirsdagWeather = forecast.data.longIntervals[yrInterval];

                    let willItRain = stirsdagWeather.precipitation > 0 ? true : false;
                    let willItBeCold = stirsdagWeather.feelsLike.value < 5 ? true : false;
                    let willitBeSuperCold = stirsdagWeather.temperature.value < -1 ? true : false;
                    
                    gearText.innerHTML = `Basert p친 v친r super-hemmelige Stirsdags-algoritme, har vi kommet opp med f칮lgende utstyrstabell for Stirsdag ${nextStirsdagDate}:</p>`;
                    
                    gearTableBody.innerHTML += weatherRow('Regnt칮y', willItRain, willItRain);
                    gearTableBody.innerHTML += weatherRow('Splitshorts', !willItBeCold, !willItBeCold);
                    gearTableBody.innerHTML += weatherRow('Base layer / tights', willItBeCold, willItBeCold);
                    gearTableBody.innerHTML += weatherRow('Terrengsko', true, true);
                    gearTableBody.innerHTML += weatherRow('Hodelykt', true, true);
                    gearTableBody.innerHTML += weatherRow('Piggsko', willitBeSuperCold, willitBeSuperCold);
                    gearTableBody.innerHTML += weatherRow('Solbriller', false, false);
                    gearTableBody.innerHTML += weatherRow('Godt hum칮r', true, true);

                });
            }).catch(error => {
                console.log(error);
                gearText.innerHTML = `Noe gikk galt. <a href="tel:004792841558">Ring HK`;
                gearTable.innerHTML = "";
            });

            setBackground(randomInt(1,14));
            
            headerEl.setAttribute("data-stirsdag", isStirsdag.toString());

            if (isStirsdag) {
                isitAnswerEl.innerHTML = answers.yes[randomInt(0,answers.yes.length)];
            }else{
                isitAnswerEl.innerHTML = `
                    Nei, i dag er det bare vanlig ${moment().locale('nb').format('dddd')} 游뱎. <br>
                    Neste Stirsdag er tirsdag ${nextStirsdagDate}.
                    <a href="https://www.facebook.com/pg/skyblazersrunning/events/">Meld deg p친 her</a>.`;
            }
        }

        

        if (window.addEventListener) window.addEventListener("load", init());
        else if (window.attachEvent) window.attachEvent("onload", init);
        else window.onload = autorun;

    </script>

</body>
</html>